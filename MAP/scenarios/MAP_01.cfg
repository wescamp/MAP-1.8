#textdomain wesnoth-MAP

[scenario]
	id=MAP_01
	next_scenario=null
	name=_ "Underground World"
	map_data="{~add-ons/MAP/maps/MAP_worldmap.map}"
	turns=-1
	
	# setup music/underground...
	
	{UNDERGROUND}
	[music]
		name=underground.ogg
	[/music]
	
	# setup sides...
	
	[side]
		id=Android
		side=1
		canrecruit=yes
		controller=human
		team_name="Android"
		gold=25
		income=-2
		fog=no
		shroud=yes
		type="Android"
		recruit=
	[/side]
	[side]
		side=2
		canrecruit=yes
		controller=ai
		team_name="Planet"
		gold=25
		income=-2
		fog=no
		shroud=yes
		type="Blade Guardian"
		recruit=
		# need to make ai agressive...
		[ai]
			aggression=1.0
			attack_depth=6
			caution=0.0
			leader_value=200.0
			grouping="no"
			simple_targeting=no
			support_villages=no
			[target]
				side=1
				canrecruit=yes
				value=200.0
			[/target]
		[/ai]
	[/side]
	
	# setup objectives...
	
	[event]
		name=prestart
		[objectives]
			side=0
			summary=_ "Explore this underground world found on the planet."
			note=_ "Hints/Tips: Right clicking will give you menu item to examine things or get help about this campaign."
			[objective]
				condition=win
				description=_ "Explore the underground world and return to the surface."
			[/objective]
			[objective]
				condition=lose
				description=_ "Death of Android."
			[/objective]
		[/objectives]
	[/event]
	
	# macro for placing items...
	
#define PLACE_ITEM_MAP XY IMAGE
	[item]
		x,y={XY}
		image={IMAGE}
	[/item]
#enddef

	# setup items/variables...
	
	[event]
		name=start
#ifdef EASY
		{MESSAGE (narrator) ("items/ball-blue.png") (_"Easy Mode") (_"Everything is avilable to you with basic creatures within the underground world. However, it can be challanging to beginners.")}
#endif
#ifdef NORMAL
		{MESSAGE (narrator) ("items/ball-green.png") (_"Normal Mode") (_"Same as easy mode. Although, extra creatures are added into the underground world. This is for players who want a challange and have played this once before.")}
#endif
#ifdef HARD
		{MESSAGE (narrator) ("items/ball-magenta.png") (_"Hard Mode") (_"Same as normal mode. Although, even more extra creatures are added into the underground world. This is for players who want a challange and have played this more than once before.")}
#endif
		{VARIABLE hook no}
		{VARIABLE boost no}
		{VARIABLE box no}
		{VARIABLE bolt_cannon no}
		{VARIABLE hammer no}
		{VARIABLE water_cannon no}
		{VARIABLE lava_cannon no}
		{VARIABLE armor_a no}
		{VARIABLE armor_b no}
		{VARIABLE armor_c no}
		{VARIABLE long_blade no}
		{VARIABLE area cave}
		{VARIABLE e 0}
		{VARIABLE escape no}
		{VARIABLE energy_boost_a no}
		{VARIABLE energy_boost_b no}
		
		{PLACE_ITEM_MAP (11,14) ("items/sceptre-of-fire.png")}
		{PLACE_ITEM_MAP (52,20) ("items/brazier-lit1.png")}
		{PLACE_ITEM_MAP (55,76) ("items/box.png")}
		{PLACE_ITEM_MAP (6,89) ("lock_key.png")}
		{PLACE_ITEM_MAP (1,6) ("lock_key.png")}
		{PLACE_ITEM_MAP (79,3) ("lock_key.png")}
		{PLACE_ITEM_MAP (19,23) ("items/chest-plain-closed.png")}
		{PLACE_ITEM_MAP (47,2) ("items/ball-blue.png")}
		{PLACE_ITEM_MAP (19,6) ("items/ball-blue.png")}
		{PLACE_ITEM_MAP (96,3) ("items/chest-plain-closed.png")}
		{PLACE_ITEM_MAP (66,35) ("items/ball-blue.png")}
		{PLACE_ITEM_MAP (1,20) ("items/chest-plain-closed.png")}
		{PLACE_ITEM_MAP (100,46) ("items/ball-blue.png")}
		{PLACE_ITEM_MAP (94,41) ("items/sceptre-of-fire.png")}
		{PLACE_ITEM_MAP (83,62) ("items/ball-blue.png")}
		{PLACE_ITEM_MAP (85,94) ("items/ball-blue.png")}
		{PLACE_ITEM_MAP (53,85) ("items/sceptre-of-fire.png")}
		{PLACE_ITEM_MAP (2,94) ("items/ball-blue.png")}
		{PLACE_ITEM_MAP (51,59) ("items/ball-blue.png")}
		{PLACE_ITEM_MAP (59,11) ("items/ball-blue.png")}
		{PLACE_ITEM_MAP (72,42) ("items/chest-plain-closed.png")}
		{PLACE_ITEM_MAP (1,71) ("items/chest-plain-closed.png")}
		{PLACE_ITEM_MAP (92,35) ("items/sceptre-of-fire.png")}
		{PLACE_ITEM_MAP (4,38) ("items/sceptre-of-fire.png")}
		{PLACE_ITEM_MAP (3,67) ("items/armor-golden.png")}
		{PLACE_ITEM_MAP (47,19) ("items/armor.png")}
		{PLACE_ITEM_MAP (14,14) ("items/dragonstatue.png")}
		{PLACE_ITEM_MAP (12,30) ("items/dragonstatue.png")}
		{PLACE_ITEM_MAP (55,22) ("items/dragonstatue.png")}
		{PLACE_ITEM_MAP (95,23) ("items/dragonstatue.png")}
		{PLACE_ITEM_MAP (99,12) ("items/dragonstatue.png")}
		{PLACE_ITEM_MAP (51,56) ("items/dragonstatue.png")}
		{PLACE_ITEM_MAP (53,75) ("items/dragonstatue.png")}
		{PLACE_ITEM_MAP (57,75) ("items/dragonstatue.png")}
		{PLACE_ITEM_MAP (51,85) ("items/dragonstatue.png")}
		{PLACE_ITEM_MAP (9,86) ("items/dragonstatue.png")}
		{PLACE_ITEM_MAP (11,87) ("items/dragonstatue.png")}
		{PLACE_ITEM_MAP (13,88) ("items/dragonstatue.png")}
		{PLACE_ITEM_MAP (15,89) ("items/dragonstatue.png")}
		{PLACE_ITEM_MAP (17,90) ("items/dragonstatue.png")}
		{PLACE_ITEM_MAP (75,24) ("items/dummy.png")}
		{PLACE_ITEM_MAP (77,11) ("items/chest-plain-closed.png")}
		{PLACE_ITEM_MAP (76,51) ("items/chest-plain-closed.png")}
		{PLACE_ITEM_MAP (100,66) ("items/chest-plain-closed.png")}
		{PLACE_ITEM_MAP (100,82) ("items/chest-plain-closed.png")}
		{PLACE_ITEM_MAP (16,67) ("items/chest-plain-closed.png")}
		{PLACE_ITEM_MAP (17,34) ("items/sceptre-of-fire.png")}
		{PLACE_ITEM_MAP (4,80) ("items/sceptre-of-fire.png")}
		{PLACE_ITEM_MAP (41,58) ("items/sceptre-of-fire.png")}
	[/event]
	
	# macro for changing music...
	
#define CHANGE_MUSIC_AREA X_RANGE Y_RANGE VAR_AREA MUSIC
	[event]
		name=moveto
		first_time_only=no
		[filter]
			x={X_RANGE}
			y={Y_RANGE}
			side=1
			canrecruit=yes
		[/filter]
		{IF_VAR area not_equals {VAR_AREA} (
			[then]
				[music]
					name={MUSIC}
					immediate=yes
				[/music]
				{VARIABLE area {VAR_AREA}}
			[/then]
		)}
	[/event]
#enddef

	# setup music...
	
	# cave...
	{CHANGE_MUSIC_AREA ("1-100") ("1-18") (cave) ("underground.ogg")}
	
	# growth...
	{CHANGE_MUSIC_AREA ("1-100") ("18-38") (growth) ("traveling_minstrels.ogg")}
	
	# water...
	{CHANGE_MUSIC_AREA ("50-100") ("39-60") (water) ("into_the_shadows.ogg")}
	
	# hot cave...
	{CHANGE_MUSIC_AREA ("50-100") ("61-80") (hot_cave) ("weight_of_revenge.ogg")}
	
	# lava cave...
	{CHANGE_MUSIC_AREA ("1-100") ("81-100") (lava_cave) ("the_deep_path.ogg")}
	
	# old ruins a...
	{CHANGE_MUSIC_AREA ("1-50") ("61-80") (old_ruins_a) ("northern_mountains.ogg")}
	
	# old ruins b...
	{CHANGE_MUSIC_AREA ("1-50") ("40-60") (old_ruins_b) ("northerners.ogg")}
	
	# macor for new weapons...
	
 #define NEW_WEAPON_UPGRADE XY VAR_WEP IMG_A NAM_A DES_A NAM_B DES_B TYP IMG_B RNG DMG NUM
 	[event]
		name=moveto
		[filter]
			x,y={XY}
			side=1
			canrecruit=yes
		[/filter]
		[removeitem]
			x,y={XY}
		[/removeitem]
		{VARIABLE {VAR_WEP} yes}
		[sound]
			name=horn-signals/horn-1.ogg
		[/sound]
		[object]
			duration=forever
			image={IMG_A}
			name={NAM_A}
			description={DES_A}
			[filter]
				side=1
				canrecruit=yes
			[/filter]
			[effect]
				apply_to=new_attack
				name={NAM_B}
				description={DES_B}
				type={TYP}
				icon={IMG_B}
				range={RNG}
				damage={DMG}
				number={NUM}
			[/effect]
		[/object]
	[/event]
 #enddef
	
	# collect upgrades...
	
	# hook...
	{NEW_WEAPON_UPGRADE (11,14) (hook) ("items/sceptre-of-fire.png") (_"Hook") (_"This allows you to hold on to grabbable terrains. (The terrain that is grabbable is the encampment castle terrain.)") (hook) (_"hook") (pierce) ("attacks/sickle.png") (ranged) (10) (1)}
	
	# bolt cannon...
	{NEW_WEAPON_UPGRADE (92,35) (bolt_cannon) ("items/sceptre-of-fire.png") (_"Bolt Cannon") (_"This allows you to shoot out a powerful bolt. (This deals pierce damage.)") (bolt cannon) (_"bolt cannon") (pierce) ("attacks/dagger-thrown-human.png") (ranged) (25) (1)}
	
	# hammer...
	{NEW_WEAPON_UPGRADE (4,38) (hammer) ("items/sceptre-of-fire.png") (_"Hammer") (_"This allows you to smash things that are in your way. (This deals impact damage.)") (hammer) (_"hammer") (impact) ("attacks/hammer-troll.png") (melee) (50) (1)}
	
	# water cannon...
	{NEW_WEAPON_UPGRADE (94,41) (water_cannon) ("items/sceptre-of-fire.png") (_"Water Cannon") (_"This allows you to shoot out a powerful blast of water. (This deals cold damage.)") (water cannon) (_"water cannon") (cold) ("attacks/iceball.png") (ranged) (25) (1)}
	
	# lava cannon...
	{NEW_WEAPON_UPGRADE (53,85) (lava_cannon) ("items/sceptre-of-fire.png") (_"Lava Cannon") (_"This allows you to shoot out a powerful blast of lava. (This deals fire damage.)") (lava cannon) (_"lava cannon") (fire) ("attacks/fireball.png") (ranged) (25) (1)}
	
	# macro for misc upgrade...
	
#define NEW_UPGRADE_MISC XY VAR_WEP OBJECT_EFFECT_WML
	[event]
		name=moveto
		[filter]
			x,y={XY}
			side=1
		[/filter]
		[removeitem]
			x,y={XY}
		[/removeitem]
		{VARIABLE {VAR_WEP} yes}
		[sound]
			name=horn-signals/horn-1.ogg
		[/sound]
		{OBJECT_EFFECT_WML}
	[/event]
#enddef
	
	# boost...
	{NEW_UPGRADE_MISC (52,20) (boost) (
		[object]
			duration=forever
			image="items/brazier-lit1.png"
			name=_ "Rocket Booster"
			description=_ "This allows you to move faster than normal. (You can now move 8 hexes per turn.)"
			[filter]
				side=1
				canrecruit=yes
			[/filter]
			[effect]
				apply_to=movement
				set=8
			[/effect]
		[/object]
	)}
	
	# box...
	{NEW_UPGRADE_MISC (55,76) (box) (
		[object]
			duration=forever
			image="items/box.png"
			name=_ "Compression Box"
			description=_ "This allows you to move in small passageways. (You can now move though deep water and caves.)"
			[filter]
				side=1
				canrecruit=yes
			[/filter]
			[effect]
				apply_to=movement_costs
				replace=yes
				[movement_costs]
					cave=1
					deep_water=1
				[/movement_costs]
			[/effect]
		[/object]
	)}
	
	# swimming armor...
	{NEW_UPGRADE_MISC (75,24) (armor_c) (
		[object]
			duration=forever
			image="items/dummy.png"
			name=_ "Swimming Armor"
			description=_ "This allows you to walk around underwater without getting electrocuted. (You can't die from water.)"
			[filter]
				side=1
				canrecruit=yes
			[/filter]
		[/object]
	)}
	
	# elemental armor...
	{NEW_UPGRADE_MISC (3,67) (armor_a) (
		[object]
			duration=forever
			image="items/armor-golden.png"
			name=_ "Elemental Armor"
			description=_ "This resists elemental damage. (50% resistance to cold, fire, and arcane.)"
			[filter]
				side=1
				canrecruit=yes
			[/filter]
			[effect]
				apply_to=resistance
				replace=no
				[resistance]
					cold=-50%
					fire=-50%
					arcane=-50%
				[/resistance]
			[/effect]
		[/object]
	)}
	
	# weapon armor...
	{NEW_UPGRADE_MISC (47,19) (armor_b) (
		[object]
			duration=forever
			image="items/armor.png"
			name=_ "Weapon Armor"
			description=_ "This resists weapon damage. (50% resistance to blade, pierce, and impact.)"
			[filter]
				side=1
				canrecruit=yes
			[/filter]
			[effect]
				apply_to=resistance
				replace=no
				[resistance]
					blade=-50%
					pierce=-50%
					impact=-50%
				[/resistance]
			[/effect]
		[/object]
	)}
	
	# energy cannon upgrade a...
	{NEW_UPGRADE_MISC (17,34) (energy_boost_a) (
		[object]
			duration=forever
			image="items/sceptre-of-fire.png"
			name=_ "Energy Cannon Upgrade"
			description=_ "This increases your energy cannon damage by 10. (This deals 10 extra arcane damage.)"
			[filter]
				side=1
				canrecruit=yes
			[/filter]
			[effect]
				apply_to=attack
				name=energy cannon
				increase_damage=10
			[/effect]
		[/object]
	)}
	
	# energy cannon upgrade b...
	{NEW_UPGRADE_MISC (4,80) (energy_boost_a) (
		[object]
			duration=forever
			image="items/sceptre-of-fire.png"
			name=_ "Energy Cannon Upgrade"
			description=_ "This increases your energy cannon damage by 10. (This deals 10 extra arcane damage.)"
			[filter]
				side=1
				canrecruit=yes
			[/filter]
			[effect]
				apply_to=attack
				name=energy cannon
				increase_damage=10
			[/effect]
		[/object]
	)}
	
	# examine stuff menu items...
	
	[event]
		name=prestart
		[set_menu_item]
			id=MAP_examine_enemy
			description=_ "Examine Enemy"
			image=misc/eye.png
			[show_if]
				[have_unit]
					side=2
					x,y=$unit.x|,$unit.y|
				[/have_unit]
			[/show_if]
			[command]
				{IF_VAR unit.type equals (Rubble Weak) (
					[then]
						{MESSAGE (narrator) ($unit.image|) (_"Examination Complete! (" + $unit.language_name| + _" )") (_"This rubble looks very weak. It should be able to be cleared by a simple energy blast.")}
					[/then]
				)}
				{IF_VAR unit.type equals (Rubble Average) (
					[then]
						{MESSAGE (narrator) ($unit.image|) (_"Examination Complete! (" + $unit.language_name| + _" )") (_"This rubble looks somewhat unstable. However, a few elemental energy blasts should be able to be clear this rubble.")}
					[/then]
				)}
				{IF_VAR unit.type equals (Rubble Strong) (
					[then]
						{MESSAGE (narrator) ($unit.image|) (_"Examination Complete! (" + $unit.language_name| + _" )") (_"This rubble doesn't look like it's going anywhere soon. Although, maybe siege-like attacks could be able to be clear this rubble.")}
					[/then]
				)}
				{IF_VAR unit.type equals (Rubble Epic) (
					[then]
						{MESSAGE (narrator) ($unit.image|) (_"Examination Complete! (" + $unit.language_name| + _" )") (_"This rubble looks to strong to be damaged by conventional means. However, it seems that blade-like attacks is a weakness of this rubble.")}
					[/then]
				)}
				{IF_VAR unit.type equals Zlap (
					[then]
						{MESSAGE (narrator) ($unit.image|) (_"Examination Complete! (" + $unit.language_name| + _" )") (_"This flying, insect-like, creature has the ability to fly very quickly. They feed off any form of energy they can find. However, they cannot heal from the drained energy.")}
					[/then]
				)}
				{IF_VAR unit.type equals Smlug (
					[then]
						{MESSAGE (narrator) ($unit.image|) (_"Examination Complete! (" + $unit.language_name| + _" )") (_"This mud-like, slug seems to love living in water environments. It has the ability to regenerate in swamp environments as well. The Smlug likes to use mud as his weapon to keep threats away.")}
					[/then]
				)}
				{IF_VAR unit.type equals Peko (
					[then]
						{MESSAGE (narrator) ($unit.image|) (_"Examination Complete! (" + $unit.language_name| + _" )") (_"This four legged, spider-like, creature has a hard outer shell with small spikes. This creature looks very hard to damage due to the resistance it has. Even it's long legs are sharp as nails. Avoid combat whenever possible.")}
					[/then]
				)}
				{IF_VAR unit.type equals Versant (
					[then]
						{MESSAGE (narrator) ($unit.image|) (_"Examination Complete! (" + $unit.language_name| + _" )") (_"This snake-like, creature likes to live in jungle-like environments. They rarely attack unless approached. When they do attack, they spew out very unique chemicals.")}
					[/then]
				)}
				{IF_VAR unit.type equals Harok (
					[then]
						{MESSAGE (narrator) ($unit.image|) (_"Examination Complete! (" + $unit.language_name| + _" )") (_"This strange, rock-like, creature is very resistance to all attacks. However, he is slow and defenceless. If you want to continue down the path, you have to kill him.")}
					[/then]
				)}
				{IF_VAR unit.type equals Sullif (
					[then]
						{MESSAGE (narrator) ($unit.image|) (_"Examination Complete! (" + $unit.language_name| + _" )") (_"This fish-like, beast is very large in size. However, it's scales are very weak and vulnerable to any based attack. (Except cold.)")}
					[/then]
				)}
				{IF_VAR unit.type equals Lavmar (
					[then]
						{MESSAGE (narrator) ($unit.image|) (_"Examination Complete! (" + $unit.language_name| + _" )") (_"This flying, insect-like, creature is basically suicidal. They live within the lava of the planets core and attack anything that gets too close. Apon attacking, they self destruct. (Throwing lava and it's own body parts.)")}
					[/then]
				)}
				{IF_VAR unit.type equals Guard (
					[then]
						{MESSAGE (narrator) ($unit.image|) (_"Examination Complete! (" + $unit.language_name| + _" )") (_"This strange, mechanical statue seems to be guarding this location. He has long, sharp, sword-like claws on his hand. Extreme caution should be used when encountering.")}
					[/then]
				)}
				{IF_VAR unit.type equals (Blade Guardian) (
					[then]
						{MESSAGE (narrator) ($unit.image|) (_"Examination Complete! (" + $unit.language_name| + _" )") (_"This strange, mechanical statue seems to be guarding this location. He has a long, sharp, sword-like blade equipped in his hand. It looks like the dragon statues seen around the planet. Extreme caution should be used when encountering the Blade Guardians.")}
					[/then]
				)}
				{IF_VAR unit.type equals (Lock) (
					[then]
						{MESSAGE (narrator) ($unit.image|) (_"Examination Complete! (" + $unit.language_name| + _" )") (_ "This lock will not be opened unless, you have the key...")}
					[/then]
				)}
				{IF_VAR unit.type equals (Nifhid) (
					[then]
						{MESSAGE (narrator) ($unit.image|) (_"Examination Complete! (" + $unit.language_name| + _" )") (_"This mechnical gun, remains hidden under the ground until, it finds something within reach to engage.")}
					[/then]
				)}
				{IF_VAR unit.type equals (Nifhod) (
					[then]
						{MESSAGE (narrator) ($unit.image|) (_"Examination Complete! (" + $unit.language_name| + _" )") (_"An upgraded version of the Nifhid. This mechnical gun, remains hidden under the ground until, it finds something within reach to engage.")}
					[/then]
				)}
				{IF_VAR unit.type equals (Nifhad) (
					[then]
						{MESSAGE (narrator) ($unit.image|) (_"Examination Complete! (" + $unit.language_name| + _" )") (_"An upgraded version of the Nifhod. This mechnical gun, remains hidden under the ground until, it finds something within reach to engage.")}
					[/then]
				)}
				{IF_VAR unit.type equals (Aynvin) (
					[then]
						{MESSAGE (narrator) ($unit.image|) (_"Examination Complete! (" + $unit.language_name| + _" )") (_"This living, plant-like, vine loves to get in the way. It has no attacks, it cannot move, and it is very weak to any attack. It's just there to annoy you.")}
					[/then]
				)}
				{IF_VAR unit.type equals (Rephel) (
					[then]
						{MESSAGE (narrator) ($unit.image|) (_"Examination Complete! (" + $unit.language_name| + _" )") (_"This mechanical, lizard-like, statue has the ability to repair and disassemble mechanical things. It will repair nifhid's, nifhod's, nifhad's and any guards nearby. However, it will attempt to disassemble the android in provoked.")}
					[/then]
				)}
				{IF_VAR unit.type equals (Liquid Guard) (
					[then]
						{MESSAGE (narrator) ($unit.image|) (_"Examination Complete! (" + $unit.language_name| + _" )") (_"This strange, liquified statue seems to be guarding this location. He has long, sharp, swords in his hands. Avoid combat whenever possible. They seem to regenerate themselves in the water and are undamageable.")}
					[/then]
				)}
			[/command]
		[/set_menu_item]
	[/event]
	
	# examine upgrade...
	
	[event]
		name=prestart
		[set_menu_item]
			id=MAP_examine_upgrade
			description=_ "Examine Upgrade"
			image=misc/eye.png
			[show_if]
				[have_location]
					x,y=$x1|,$y1|
					terrain=Co
				[/have_location]
			[/show_if]
			[command]
				[message]
					speaker=narrator
					message=_ "This appears to be some kind of upgradable item for you. Move to it to find out what ability/upgrade/weapon it is."
					caption=_ "Examination Complete! ( Upgrade )"
					image="terrain/castle/orcish/tile.png"
				[/message]
			[/command]
		[/set_menu_item]
	[/event]
	
	# examine lock...
	
	[event]
		name=prestart
		[set_menu_item]
			id=MAP_examine_mechanism
			description=_ "Examine Mechanism"
			image=misc/eye.png
			[show_if]
				[have_location]
					x,y=$x1|,$y1|
					terrain=Ch
				[/have_location]
			[/show_if]
			[command]
				[message]
					speaker=narrator
					message=_ "This appears to be some kind of locking mechanism. Move to it to unlock something inside the underground world."
					caption=_ "Examination Complete! ( Locking Mechanism )"
					image="terrain/castle/castle-tile.png"
				[/message]
			[/command]
		[/set_menu_item]
	[/event]
	
	# examine recharge machine...
	
	[event]
		name=prestart
		[set_menu_item]
			id=MAP_examine_machine
			description=_ "Examine Machine"
			image=misc/eye.png
			[show_if]
				[have_location]
					x,y=$x1|,$y1|
					terrain=Cud
				[/have_location]
			[/show_if]
			[command]
				[message]
					speaker=narrator
					message=_ "This appears to be some kind of recharging machine of some sort. Moving to it could recharge your energy cores."
					caption=_ "Examination Complete! ( Recharging Machine )"
					image="terrain/castle/dwarven-castle-tile.png"
				[/message]
			[/command]
		[/set_menu_item]
	[/event]
	
	# examine grabbable hook...
	
	[event]
		name=prestart
		[set_menu_item]
			id=MAP_examine_hook
			description=_ "Examine Hook"
			image=misc/eye.png
			[show_if]
				[have_location]
					x,y=$x1|,$y1|
					terrain=Ce
				[/have_location]
			[/show_if]
			[command]
				[message]
					speaker=narrator
					message=_ "This appears to be some kind of grabbable hook. If you move here with a hook-like device, you should be able to hold on to it."
					caption=_ "Examination Complete! ( Grabbable Hook )"
					image="terrain/castle/encampment-tile.png"
				[/message]
			[/command]
		[/set_menu_item]
	[/event]
	
	# examine guard statue...
	
	[event]
		name=prestart
		[set_menu_item]
			id=MAP_examine_statue
			description=_ "Examine Statue"
			image=misc/eye.png
			[show_if]
				[have_location]
					x,y=$x1|,$y1|
					terrain=Cv
				[/have_location]
			[/show_if]
			[command]
				[message]
					speaker=narrator
					message=_ "This appears to be some kind of statue; representing a race. It looks dragon-like in design. This means, intelligent life form(s) may exist on this planet."
					caption=_ "Examination Complete! ( Statue of a Race )"
					image="items/dragonstatue.png"
				[/message]
			[/command]
		[/set_menu_item]
	[/event]
	
	# examine guard statue...
	
	[event]
		name=prestart
		[set_menu_item]
			id=MAP_examine_tower
			description=_ "Examine Tower"
			image=misc/eye.png
			[show_if]
				[have_location]
					x,y=$x1|,$y1|
					terrain=Kv
				[/have_location]
			[/show_if]
			[command]
				[message]
					speaker=narrator
					message=_ "This appears to be some kind of tower; The guards like to hide within these towers."
					caption=_ "Examination Complete! ( Tower )"
					image="terrain/castle/elven/keep-tile.png"
				[/message]
			[/command]
		[/set_menu_item]
	[/event]
	
	# key macro...
	
#define PLACE_KEY MOVEXY TERRAINX TERRAINY
	[event]
		name=moveto
		[filter]
			x,y={MOVEXY}
		[/filter]
		[removeitem]
			x,y={MOVEXY}
		[/removeitem]
		{MODIFY_TERRAIN Re {TERRAINX} {TERRAINY}}
		[kill]
			x,y={TERRAINX},{TERRAINY}
		[/kill]
		[sound]
			name=horn-signals/horn-1.ogg
		[/sound]
	[/event]
#enddef
	
	# ammo macro...
	
#define PLACE_AMMO XY
	[event]
		name=moveto
		[filter]
			x,y={XY}
			side=1
			canrecruit=yes
			has_weapon=bolt cannon
		[/filter]
		[removeitem]
			x,y={XY}
		[/removeitem]
		[sound]
			name=horn-signals/horn-1.ogg
		[/sound]
		[object]
			duration=forever
			image="items/chest-plain-open.png"
			name=_ "Bolt Cannon Ammo"
			description=_ "This gives you +5 ammo. (You can now shoot 5 extra bolts. However, they run out when used. Although, you will always have at least one.)"
			[filter]
				side=1
				canrecruit=yes
			[/filter]
			[effect]
				apply_to=attack
				name=bolt cannon
				increase_attacks=5
			[/effect]
		[/object]
		[store_unit]
			[filter]
				side=1
				canrecruit=yes
			[/filter]
			kill=yes
			variable=hero
		[/store_unit]
		[unstore_unit]
			variable=hero
		[/unstore_unit]
		[redraw]
		[/redraw]
	[/event]
#enddef

#define PLACE_AMMO_CANT_USE XY
	[event]
		name=moveto
		first_time_only=no
		[filter]
			x,y={XY}
			side=1
			canrecruit=yes
			[not]
				has_weapon=bolt cannon
			[/not]
		[/filter]
		[message]
			speaker=narrator
			image="items/chest-plain-open.png"
			catpion=_ "Unable to Use"
			message=_ "It seems there is some kind of bolt ammo here. However, you would need some kind of cannon to use these."
		[/message]
	[/event]
#enddef

#define PLACE_ENERGY XY
	[event]
		name=moveto
		[filter]
			x,y={XY}
			side=1
		[/filter]
		[removeitem]
			x,y={XY}
		[/removeitem]
		[sound]
			name=horn-signals/horn-1.ogg
		[/sound]
		[object]
			duration=forever
			image="items/ball-blue.png"
			name=_ "Energy Core"
			description=_ "This gives you +50 energy. (You now got +50 maximum hitpoints.)"
			[filter]
				side=1
				canrecruit=yes
			[/filter]
			[effect]
				apply_to=hitpoints
				increase_total=50
				increase=50
			[/effect]
		[/object]
		[store_unit]
			[filter]
				side=1
				canrecruit=yes
			[/filter]
			kill=yes
			variable=hero
		[/store_unit]
		[unstore_unit]
			variable=hero
		[/unstore_unit]
		[redraw]
		[/redraw]
	[/event]
#enddef
	
	# key a...
	{PLACE_KEY (1,6) 7 85}
	
	# key b...
	{PLACE_KEY (6,89) 5 85}
	
	# key c...
	{PLACE_KEY (79,3) 3 85}
	
	# ammo a...
	{PLACE_AMMO (19,23)}
	{PLACE_AMMO_CANT_USE (19,23)}
	
	# ammo b...
	{PLACE_AMMO (96,3)}
	{PLACE_AMMO_CANT_USE (96,3)}
	
	# ammo c...
	{PLACE_AMMO (1,20)}
	{PLACE_AMMO_CANT_USE (1,20)}
	
	# ammo d...
	{PLACE_AMMO (72,42)}
	{PLACE_AMMO_CANT_USE (72,42)}
	
	# ammo e...
	{PLACE_AMMO (1,71)}
	{PLACE_AMMO_CANT_USE (1,71)}
	
	# ammo f...
	{PLACE_AMMO (77,11)}
	{PLACE_AMMO_CANT_USE (77,11)}
	
	# ammo g...
	{PLACE_AMMO (76,51)}
	{PLACE_AMMO_CANT_USE (76,51)}
	
	# ammo h...
	{PLACE_AMMO (100,66)}
	{PLACE_AMMO_CANT_USE (100,66)}
	
	# ammo i...
	{PLACE_AMMO (100,82)}
	{PLACE_AMMO_CANT_USE (100,82)}
	
	# ammo j...
	{PLACE_AMMO (16,67)}
	{PLACE_AMMO_CANT_USE (16,67)}
	
	# energy a...
	{PLACE_ENERGY (47,2)}
	
	# energy b...
	{PLACE_ENERGY (19,6)}
	
	# energy c...
	{PLACE_ENERGY (66,35)}
	
	# energy d...
	{PLACE_ENERGY (100,46)}
	
	# energy e...
	{PLACE_ENERGY (83,62)}
	
	# energy f...
	{PLACE_ENERGY (85,94)}
	
	# energy g...
	{PLACE_ENERGY (2,94)}
	
	# energy h...
	{PLACE_ENERGY (51,59)}
	
	# energy i...
	{PLACE_ENERGY (59,11)}
	
	# spawn all the enemies...
	
	[event]
		name=prestart
		
		# ribble first...
		
		{UNIT 2 ("Rubble Weak") 20 3 (ai_special=guardian)}
		{UNIT 2 ("Rubble Weak") 50 9 (ai_special=guardian)}
		{UNIT 2 ("Rubble Epic") 41 17 (ai_special=guardian)}
		{UNIT 2 ("Rubble Weak") 28 16 (ai_special=guardian)}
		{UNIT 2 ("Rubble Average") 4 17 (ai_special=guardian)}
		{UNIT 2 ("Rubble Average") 20 38 (ai_special=guardian)}
		{UNIT 2 ("Rubble Average") 28 38 (ai_special=guardian)}
		{UNIT 2 ("Rubble Average") 28 27 (ai_special=guardian)}
		{UNIT 2 ("Rubble Strong") 20 21 (ai_special=guardian)}
		{UNIT 2 ("Rubble Average") 28 20 (ai_special=guardian)}
		{UNIT 2 ("Rubble Average") 50 38 (ai_special=guardian)}
		{UNIT 2 ("Rubble Average") 66 38 (ai_special=guardian)}
		{UNIT 2 ("Rubble Average") 82 38 (ai_special=guardian)}
		{UNIT 2 ("Rubble Average") 66 29 (ai_special=guardian)}
		{UNIT 2 ("Rubble Average") 58 22 (ai_special=guardian)}
		{UNIT 2 ("Rubble Strong") 99 18 (ai_special=guardian)}
		{UNIT 2 ("Rubble Strong") 54 61 (ai_special=guardian)}
		{UNIT 2 ("Rubble Average") 67 69 (ai_special=guardian)}
		{UNIT 2 ("Rubble Average") 84 69 (ai_special=guardian)}
		{UNIT 2 ("Rubble Strong") 67 78 (ai_special=guardian)}
		{UNIT 2 ("Rubble Strong") 98 81 (ai_special=guardian)}
		{UNIT 2 ("Rubble Average") 50 93 (ai_special=guardian)}
		{UNIT 2 ("Rubble Strong") 16 80 (ai_special=guardian)}
		{UNIT 2 ("Rubble Average") 32 80 (ai_special=guardian)}
		{UNIT 2 ("Rubble Strong") 16 71 (ai_special=guardian)}
		{UNIT 2 ("Rubble Strong") 4 40 (ai_special=guardian)}
		{UNIT 2 ("Rubble Strong") 46 59 (ai_special=guardian)}
		{UNIT 2 ("Lock") 3 85 (ai_special=guardian)}
		{UNIT 2 ("Lock") 5 85 (ai_special=guardian)}
		{UNIT 2 ("Lock") 7 85 (ai_special=guardian)}
		
		# enemies now...
		
		# easy mode...
		
		{UNIT 2 ("Smlug") 10 6 (ai_special=guardian)}
		{UNIT 2 ("Zlap") 16 2 (ai_special=guardian)}
		{UNIT 2 ("Zlap") 22 1 (ai_special=guardian)}
		{UNIT 2 ("Zlap") 29 1 (ai_special=guardian)}
		{UNIT 2 ("Zlap") 39 1 (ai_special=guardian)}
		{UNIT 2 ("Zlap") 33 11 (ai_special=guardian)}
		{UNIT 2 ("Smlug") 18 16 (ai_special=guardian)}
		{UNIT 2 ("Smlug") 20 16 (ai_special=guardian)}
		{UNIT 2 ("Zlap") 6 14 (ai_special=guardian)}
		{UNIT 2 ("Peko") 9 38 (ai_special=guardian)}
		{UNIT 2 ("Peko") 14 33 (ai_special=guardian)}
		{UNIT 2 ("Versant") 13 21 (ai_special=guardian)}
		{UNIT 2 ("Peko") 24 24 (ai_special=guardian)}
		{UNIT 2 ("Versant") 22 31 (ai_special=guardian)}
		{UNIT 2 ("Harok") 47 23 (ai_special=guardian)}
		{UNIT 2 ("Harok") 33 33 (ai_special=guardian)}
		{UNIT 2 ("Harok") 47 35 (ai_special=guardian)}
		{UNIT 2 ("Harok") 70 30 (ai_special=guardian)}
		{UNIT 2 ("Harok") 34 24 (ai_special=guardian)}
		{UNIT 2 ("Zlap") 67 5 (ai_special=guardian)}
		{UNIT 2 ("Zlap") 79 5 (ai_special=guardian)}
		{UNIT 2 ("Zlap") 100 7 (ai_special=guardian)}
		{UNIT 2 ("Sullif") 54 12 (ai_special=guardian)}
		{UNIT 2 ("Sullif") 65 13 (ai_special=guardian)}
		{UNIT 2 ("Sullif") 72 12 (ai_special=guardian)}
		{UNIT 2 ("Sullif") 89 14 (ai_special=guardian)}
		{UNIT 2 ("Sullif") 99 15 (ai_special=guardian)}
		{UNIT 2 ("Sullif") 90 48 (ai_special=guardian)}
		{UNIT 2 ("Sullif") 88 57 (ai_special=guardian)}
		{UNIT 2 ("Sullif") 76 47 (ai_special=guardian)}
		{UNIT 2 ("Smlug") 67 59 (ai_special=guardian)}
		{UNIT 2 ("Smlug") 71 59 (ai_special=guardian)}
		{UNIT 2 ("Smlug") 52 48 (ai_special=guardian)}
		{UNIT 2 ("Smlug") 33 38 (ai_special=guardian)}
		{UNIT 2 ("Smlug") 72 37 (ai_special=guardian)}
		{UNIT 2 ("Smlug") 75 38 (ai_special=guardian)}
		{UNIT 2 ("Smlug") 74 29 (ai_special=guardian)}
		{UNIT 2 ("Smlug") 77 29 (ai_special=guardian)}
		{UNIT 2 ("Peko") 89 37 (ai_special=guardian)}
		{UNIT 2 ("Versant") 95 30 (ai_special=guardian)}
		{UNIT 2 ("Peko") 53 26 (ai_special=guardian)}
		{UNIT 2 ("Peko") 65 32 (ai_special=guardian)}
		{UNIT 2 ("Guard") 10 75 (ai_special=guardian)}
		{UNIT 2 ("Guard") 28 73 (ai_special=guardian)}
		{UNIT 2 ("Guard") 46 75 (ai_special=guardian)}
		{UNIT 2 ("Guard") 44 66 (ai_special=guardian)}
		{UNIT 2 ("Guard") 23 63 (ai_special=guardian)}
		{UNIT 2 ("Guard") 13 54 (ai_special=guardian)}
		{UNIT 2 ("Guard") 12 44 (ai_special=guardian)}
		{UNIT 2 ("Guard") 19 40 (ai_special=guardian)}
		{UNIT 2 ("Guard") 25 47 (ai_special=guardian)}
		{UNIT 2 ("Guard") 26 56 (ai_special=guardian)}
		{UNIT 2 ("Guard") 30 40 (ai_special=guardian)}
		{UNIT 2 ("Guard") 39 54 (ai_special=guardian)}
		{UNIT 2 ("Guard") 41 46 (ai_special=guardian)}
		{UNIT 2 ("Lavmar") 62 69 (ai_special=guardian)}
		{UNIT 2 ("Lavmar") 75 69 (ai_special=guardian)}
		{UNIT 2 ("Lavmar") 92 69 (ai_special=guardian)}
		{UNIT 2 ("Lavmar") 77 78 (ai_special=guardian)}
		{UNIT 2 ("Lavmar") 89 91 (ai_special=guardian)}
		{UNIT 2 ("Lavmar") 79 92 (ai_special=guardian)}
		{UNIT 2 ("Lavmar") 65 91 (ai_special=guardian)}
		{UNIT 2 ("Lavmar") 57 91 (ai_special=guardian)}
		{UNIT 2 ("Lavmar") 40 87 (ai_special=guardian)}
		{UNIT 2 ("Lavmar") 31 90 (ai_special=guardian)}
		{UNIT 2 ("Lavmar") 21 88 (ai_special=guardian)}
		{UNIT 2 ("Lavmar") 11 100 (ai_special=guardian)}
		{UNIT 2 ("Blade Guardian") 41 58 (ai_special=guardian)}
		{UNIT 2 ("Nifhid") 18 59 (ai_special=guardian)}
		
		# normal mode...

#ifdef NORMAL
		{UNIT 2 ("Zlap") 8 1 (ai_special=guardian)}
		{UNIT 2 ("Nifhid") 31 9 (ai_special=guardian)}
		{UNIT 2 ("Zlap") 49 2 (ai_special=guardian)}
		{UNIT 2 ("Zlap") 40 17 (ai_special=guardian)}
		{UNIT 2 ("Zlap") 13 12 (ai_special=guardian)}
		{UNIT 2 ("Harok") 6 12 (ai_special=guardian)}
		{UNIT 2 ("Peko") 22 35 (ai_special=guardian)}
		{UNIT 2 ("Peko") 7 33 (ai_special=guardian)}
		{UNIT 2 ("Smlug") 41 35 (ai_special=guardian)}
		{UNIT 2 ("Nifhid") 94 37 (ai_special=guardian)}
		{UNIT 2 ("Versant") 61 22 (ai_special=guardian)}
		{UNIT 2 ("Aynvin") 69 20 (ai_special=guardian)}
		{UNIT 2 ("Aynvin") 77 20 (ai_special=guardian)}
		{UNIT 2 ("Aynvin") 81 20 (ai_special=guardian)}
		{UNIT 2 ("Aynvin") 88 35 (ai_special=guardian)}
		{UNIT 2 ("Aynvin") 60 36 (ai_special=guardian)}
		{UNIT 2 ("Aynvin") 32 35 (ai_special=guardian)}
		{UNIT 2 ("Aynvin") 26 37 (ai_special=guardian)}
		{UNIT 2 ("Rephel") 15 73 (ai_special=guardian)}
		{UNIT 2 ("Rephel") 28 63 (ai_special=guardian)}
		{UNIT 2 ("Rephel") 49 77 (ai_special=guardian)}
		{UNIT 2 ("Rephel") 19 55 (ai_special=guardian)}
		{UNIT 2 ("Rephel") 34 49 (ai_special=guardian)}
		{UNIT 2 ("Liquid Guard") 88 42 (ai_special=guardian)}
		{UNIT 2 ("Nifhod") 86 74 (ai_special=guardian)}
		{UNIT 2 ("Nifhod") 14 88 (ai_special=guardian)}
		{UNIT 2 ("Nifhod") 29 56 (ai_special=guardian)}
		{UNIT 2 ("Nifhad") 11 80 (ai_special=guardian)}
		{UNIT 2 ("Nifhad") 47 70 (ai_special=guardian)}
#endif
		
		# hard mode...
		
#ifdef HARD
		{UNIT 2 ("Zlap") 8 1 (ai_special=guardian)}
		{UNIT 2 ("Nifhid") 31 9 (ai_special=guardian)}
		{UNIT 2 ("Zlap") 49 2 (ai_special=guardian)}
		{UNIT 2 ("Zlap") 40 17 (ai_special=guardian)}
		{UNIT 2 ("Zlap") 13 12 (ai_special=guardian)}
		{UNIT 2 ("Harok") 6 12 (ai_special=guardian)}
		{UNIT 2 ("Peko") 22 35 (ai_special=guardian)}
		{UNIT 2 ("Peko") 7 33 (ai_special=guardian)}
		{UNIT 2 ("Smlug") 41 35 (ai_special=guardian)}
		{UNIT 2 ("Nifhid") 94 37 (ai_special=guardian)}
		{UNIT 2 ("Versant") 61 22 (ai_special=guardian)}
		{UNIT 2 ("Aynvin") 69 20 (ai_special=guardian)}
		{UNIT 2 ("Aynvin") 77 20 (ai_special=guardian)}
		{UNIT 2 ("Aynvin") 81 20 (ai_special=guardian)}
		{UNIT 2 ("Aynvin") 88 35 (ai_special=guardian)}
		{UNIT 2 ("Aynvin") 60 36 (ai_special=guardian)}
		{UNIT 2 ("Aynvin") 26 37 (ai_special=guardian)}
		{UNIT 2 ("Rephel") 15 73 (ai_special=guardian)}
		{UNIT 2 ("Rephel") 28 63 (ai_special=guardian)}
		{UNIT 2 ("Rephel") 49 77 (ai_special=guardian)}
		{UNIT 2 ("Rephel") 19 55 (ai_special=guardian)}
		{UNIT 2 ("Rephel") 34 49 (ai_special=guardian)}
		{UNIT 2 ("Liquid Guard") 88 42 (ai_special=guardian)}
		{UNIT 2 ("Nifhod") 86 74 (ai_special=guardian)}
		{UNIT 2 ("Nifhod") 14 88 (ai_special=guardian)}
		{UNIT 2 ("Nifhod") 29 56 (ai_special=guardian)}
		{UNIT 2 ("Nifhad") 11 80 (ai_special=guardian)}
		{UNIT 2 ("Nifhad") 47 70 (ai_special=guardian)}
		
		{UNIT 2 ("Nifhid") 15 4 (ai_special=guardian)}
		{UNIT 2 ("Zlap") 47 7 (ai_special=guardian)}
		{UNIT 2 ("Zlap") 49 8 (ai_special=guardian)}
		{UNIT 2 ("Zlap") 36 17 (ai_special=guardian)}
		{UNIT 2 ("Nifhid") 24 14 (ai_special=guardian)}
		{UNIT 2 ("Zlap") 2 15 (ai_special=guardian)}
		{UNIT 2 ("Harok") 2 12 (ai_special=guardian)}
		{UNIT 2 ("Nifhid") 1 38 (ai_special=guardian)}
		{UNIT 2 ("Versant") 27 23 (ai_special=guardian)}
		{UNIT 2 ("Nifhid") 16 21 (ai_special=guardian)}
		{UNIT 2 ("Harok") 40 30 (ai_special=guardian)}
		{UNIT 2 ("Nifhid") 59 38 (ai_special=guardian)}
		{UNIT 2 ("Nifhid") 53 22 (ai_special=guardian)}
		{UNIT 2 ("Aynvin") 73 20 (ai_special=guardian)}
		{UNIT 2 ("Aynvin") 85 20 (ai_special=guardian)}
		{UNIT 2 ("Aynvin") 90 20 (ai_special=guardian)}
		{UNIT 2 ("Aynvin") 80 34 (ai_special=guardian)}
		{UNIT 2 ("Aynvin") 46 27 (ai_special=guardian)}
		{UNIT 2 ("Aynvin") 36 22 (ai_special=guardian)}
		{UNIT 2 ("Aynvin") 32 35 (ai_special=guardian)}
		{UNIT 2 ("Aynvin") 23 27 (ai_special=guardian)}
		{UNIT 2 ("Smlug") 30 29 (ai_special=guardian)}
		{UNIT 2 ("Zlap") 56 2 (ai_special=guardian)}
		{UNIT 2 ("Nifhid") 59 9 (ai_special=guardian)}
		{UNIT 2 ("Rephel") 31 1 (ai_special=guardian)}
		{UNIT 2 ("Rephel") 26 11 (ai_special=guardian)}
		{UNIT 2 ("Rephel") 60 3 (ai_special=guardian)}
		{UNIT 2 ("Rephel") 79 84 (ai_special=guardian)}
		{UNIT 2 ("Rephel") 65 85 (ai_special=guardian)}
		{UNIT 2 ("Rephel") 5 63 (ai_special=guardian)}
		{UNIT 2 ("Rephel") 21 74 (ai_special=guardian)}
		{UNIT 2 ("Rephel") 47 66 (ai_special=guardian)}
		{UNIT 2 ("Rephel") 20 49 (ai_special=guardian)}
		{UNIT 2 ("Rephel") 41 51 (ai_special=guardian)}
		{UNIT 2 ("Rephel") 25 44 (ai_special=guardian)}
		{UNIT 2 ("Liquid Guard") 65 49 (ai_special=guardian)}
		{UNIT 2 ("Liquid Guard") 85 11 (ai_special=guardian)}
		{UNIT 2 ("Nifhod") 57 64 (ai_special=guardian)}
		{UNIT 2 ("Nifhod") 92 62 (ai_special=guardian)}
		{UNIT 2 ("Nifhod") 52 85 (ai_special=guardian)}
		{UNIT 2 ("Nifhod") 10 86 (ai_special=guardian)}
		{UNIT 2 ("Nifhad") 43 59 (ai_special=guardian)}
		{UNIT 2 ("Nifhad") 19 70 (ai_special=guardian)}
		{UNIT 2 ("Nifhad") 41 78 (ai_special=guardian)}
		{UNIT 2 ("Harok") 21 7 (ai_special=guardian)}
		{UNIT 2 ("Harok") 17 7 (ai_special=guardian)}
#endif
		
	[/event]
	
	# rubble deaths...
	
	[event]
		name=die
		first_time_only=no
		[filter]
			side=2
			type="Rubble Weak", "Rubble Average", "Rubble Strong", "Rubble Epic"
		[/filter]
		{MODIFY_TERRAIN Rr $x1| $y1|}
	[/event]
	
	# create a energy sphere when specific enemy dies and give it to the player...
	
	[event]
		name=die
		first_time_only=no
		[filter]
			side=2
			type="Blade Guardian", "Gaurd", "Lavmar", "Nifhid", "Zlap", "Nifhod", "Nifhad"
		[/filter]
		[object]
			duration=forever
			image="energy.png"
			name=_ "Energy Sphere"
			description=_ "This restores you 10 energy. (Heals 10 hitpoints.)"
			[filter]
				side=1
				canrecruit=yes
			[/filter]
			[effect]
				apply_to=hitpoints
				increase=10
				violate_maximum=""
			[/effect]
		[/object]
		[store_unit]
			[filter]
				side=1
				canrecruit=yes
			[/filter]
			kill=yes
			variable=hero
		[/store_unit]
		[unstore_unit]
			variable=hero
		[/unstore_unit]
		[redraw]
		[/redraw]
	[/event]
	
	# ending trigger...
	
	[event]
		name=moveto
		first_time_only=no
		[filter]
			x="1-8"
			y="1-5"
			side=1
			canrecruit=yes
		[/filter]
		{IF_VAR escape equals yes (
			[then]
				[message]
					side=1
					canrecruit=yes
					image="android.png"
					message=_ "Falcon XVI, I am returning to the ship... It seems that there is intelligent life forms here... However, all of them became hostile toward me... I acquired a lot of data from this race... I will inform you once I arrive."
				[/message]
				[message]
					speaker=narrator
					caption=_ "Falcon XVI"
					message=_ "Acknowledged."
				[/message]
				[endlevel]
					result=victory
				[/endlevel]
			[/then]
		)}
	[/event]
	
	# teleport up shaft...
	
	[event]
		name=moveto
		[filter]
			x,y=48,40
			canrecruit=yes
			side=1
		[/filter]
		{TELEPORT_UNIT (side=1 canrecruit=yes) 49 17}
		[scroll_to]
			x,y=49,17
		[/scroll_to]
	[/event]
	
	# ammo use up...
	
	[event]
		name=attacker hits,attacker misses
		first_time_only=no
		[filter]
			side=1
			canrecruit=yes
		[/filter]
		[filter_attack]
			name=bolt cannon
		[/filter_attack]
		[object]
			duration=forever
			silent=yes
			image="items/chest-plain-open.png"
			name=_ "Bolt Ammo"
			description=_ "You used up a bolt. Add -1 to attacks."
			[filter]
				side=1
				canrecruit=yes
			[/filter]
			[effect]
				apply_to=attack
				name=bolt cannon
				increase_attacks=-1
			[/effect]
		[/object]
	[/event]
	
	[event]
		name=defender hits, defender misses
		first_time_only=no
		[filter_second]
			side=1
			canrecruit=yes
		[/filter_second]
		[filter_attack]
			name=bolt cannon
		[/filter_attack]
		[object]
			duration=forever
			silent=yes
			image="items/chest-plain-open.png"
			name=_ "Bolt Ammo"
			description=_ "You used up a bolt. Add -1 to attacks."
			[filter]
				side=1
				canrecruit=yes
			[/filter]
			[effect]
				apply_to=attack
				name=bolt cannon
				increase_attacks=-1
			[/effect]
		[/object]
	[/event]
	
	# every new turn, the android is drained of 2 energy...
	# edit: we also need to reset the xp too... the enemies don't attack if about to level up...
	
	[event]
		name=side turn
		first_time_only=no
		{VARIABLE dead no}
		{IF_VAR side_number equals 1 (
			[then]
				[store_unit]
					[filter]
						side=1
						canrecruit=yes
					[/filter]
					kill=yes
					variable=hero
				[/store_unit]
				{VARIABLE_OP hero.hitpoints sub 2}
				{VARIABLE hero.experience 0}
				{IF_VAR hero.hitpoints less_than_equal_to 0 (
					[then]
						{VARIABLE dead yes}
					[/then]
				)}
				[unstore_unit]
					variable=hero
				[/unstore_unit]
			[/then]
		)}
		{IF_VAR dead equals yes (
			[then]
				[kill]
					side=1
					canrecruit=yes
					fire_event=yes
					animate=yes
				[/kill]
			[/then]
		)}
	[/event]
	
	# special enemy case... lavmar...	
	# self destruct hits...
	
	[event]
		name=attacker hits
		first_time_only=no
		[filter]
			side=2
			type=Lavmar
		[/filter]
		[filter_attack]
			name=self destruct
		[/filter_attack]
		[kill]
			x,y=$unit.x|,$unit.y|
			animate=yes
			fire_event=yes
		[/kill]
	[/event]
	
	# final boss trigger...
	
	[event]
		name=moveto
		[filter]
			x="6-20"
			y="40-59"
			side=1
			canrecruit=yes
		[/filter]
		{MODIFY_TERRAIN Xos (5,28,50) (57,16,9)}
		{VARIABLE escape yes}
		{UNIT 2 ("Lock") 5 57 (ai_special=guardian)}
		{UNIT 2 ("Lock") 28 16 (ai_special=guardian)}
		{UNIT 2 ("Lock") 50 9 (ai_special=guardian)}
		[message]
			speaker=narrator
			message=_ "Intruder detected... Activating Blade Guardian... Task complete..."
			caption=_ "Unknown Speaker"
		[/message]
		[message]
			speaker=narrator
			message=_ "Activating lock down mode... Task complete..."
			caption=_ "Unknown Speaker"
		[/message]
	[/event]
	
	# android dies...
	
	[event]
		name=die
		[filter]
			side=1
			canrecruit=yes
		[/filter]
		[sound]
			name=explosion.ogg
		[/sound]
		[message]
			canrecruit=yes
			side=1
			image="android.png"
			message=_ "Energy supply failure... Self Destruct activated!"
		[/message]
		[endlevel]
			result=defeat
		[/endlevel]
	[/event]
	
	# boss dies...
	
	# blade guardian death...
	
	[event]
		name=die
		[filter]
			type="Blade Guardian"
			side=2
		[/filter]
		[message]
			speaker=narrator
			message=_ "Blade Guardian destroyed... Results... Impossible... Error... Error... Warning... System shutting down..."
		[/message]
		[message]
			canrecruit=yes
			side=1
			image="android.png"
			message=_ "This race is very advanced in technology. However, they seem to be very hostile to outsiders. I need to return to the Falcon XVI and report my findings. I just need to return to that large hole in the wall back at the top. Although, I may have to find another way to escape this place. Most of the doors nearby are all locked."
		[/message]
		{VARIABLE escape yes}
	[/event]
	
	# note that players can get the blade but, they cannot win the scenario until they kill the blade guardian...
	
	# long blade...
	
	[event]
		name=moveto
		[filter]
			x,y=41,58
			side=1
		[/filter]
		[removeitem]
			x,y=$x1|,$y1|
		[/removeitem]
		{VARIABLE long_blade yes}
		[sound]
			name=horn-signals/horn-1.ogg
		[/sound]
		[object]
			duration=forever
			image="items/sceptre-of-fire.png"
			name=_ "Long Blade"
			description=_ "This allows you to shoot swing a long, powerful, sword. (This deals blade damage.)"
			[filter]
				side=1
				canrecruit=yes
			[/filter]
			[effect]
				apply_to=new_attack
				name=long blade
				description=_ "long blade"
				type=blade
				icon=attacks/greatsword-elven.png
				range=melee
				damage=50
				number=1
			[/effect]
		[/object]
		[message]
			canrecruit=yes
			side=1
			image="android.png"
			message=_ "This should help me make my escape. I just need to find a way out of here."
		[/message]
	[/event]
	
	# setup gravity movement...
	
	# note: so many changes was made to this overtime...
	# note: please re-read this over and modify later...
	# note: i seperated both gravity code events for enemies and the android...
	# let's hope no new bugs come up with this re-added back in...
	
	# this happens every time you move or finish attacking...
	
	[event]
		name=moveto,attack end
		first_time_only=no
		[filter]
			side=1
			canrecruit=yes
			type="Android"
		[/filter]
		[while]
			
			# while there is no Ce/Ce^li terrains at current location and does not have the hook, no Xu/Xos terrains below you, and no enemies below you, you can fall...
			
			[have_location]
				x,y=$unit.x,$unit.y
				[not]
					terrain=Ce,Ce^li
					[filter]
						side=1
						has_weapon=hook
					[/filter]
				[/not]
				[filter_adjacent_location]
					adjacent=s
					[not]
						terrain=Xu,Xos
					[/not]
					[not]
						[filter]
							side=2
						[/filter]
					[/not]
				[/filter_adjacent_location]
			[/have_location]
			[do]
				
				# falling code...
				
				# scroll 1 hex down, kill/create new leader with +1 to y, and play a sound as if he is falling...
				
				[scroll_to]
					x,y=$unit.x,$unit.y
				[/scroll_to]
				[kill]
					x,y=$unit.x,$unit.y
				[/kill]
				{VARIABLE_OP unit.y add 1}
				[unstore_unit]
					variable=unit
					find_vacant=no
				[/unstore_unit]
				[sound]
					name=dagger-swish.wav
				[/sound]
				
				# we must know where we fell to...
				
				[store_locations]
					x=$unit.x|
					y=$unit.y|
					variable=ter
				[/store_locations]
				
				# landing in water sound/death...
				
				{IF_VAR ter.terrain equals Ww (
					[then]
						[sound]
							name=water-blast.wav
						[/sound]
						
						# you don't have the armor to swim in water... you will die...
						
						{IF_VAR armor_c equals no (
							[then]
								[kill]
									side=1
									canrecruit=yes
									fire_event=yes
								[/kill]
							[/then]
						)}
					[/then]
				)}
				
				# landing in swamp sound/death...
				
				{IF_VAR ter.terrain equals Ss (
					[then]
						[sound]
							name=water-blast.wav
						[/sound]
						
						# you don't have the armor to swim in water... you will die...
						
						{IF_VAR armor_c equals no (
							[then]
								[kill]
									side=1
									canrecruit=yes
									fire_event=yes
								[/kill]
							[/then]
						)}
					[/then]
				)}
				
				# landing in lava sound/death...
				
				{IF_VAR ter.terrain equals Qlf (
					[then]
						
						# you die no matter what...
						
						[sound]
							name=fire.wav
						[/sound]
						[kill]
							side=1
							canrecruit=yes
							fire_event=yes
						[/kill]
					[/then]
				)}
				
				# catch onto something with hook...
				
				{IF_VAR ter.terrain equals Ce (
					[then]
						{IF_VAR hook equals yes (
							[then]
								[sound]
									name=dart.wav
								[/sound]
							[/then]
						)}
					[/then]
				)}
				
				# land on recharge machine...
				
				{IF_VAR ter.terrain equals Cud (
					[then]
						{IF_VAR unit.hitpoints not_equals $unit.max_hitpoints| (
							[then]
								[sound]
									name=lightning-miss.ogg
								[/sound]
								[kill]
									x,y=$unit.x,$unit.y
								[/kill]
								{VARIABLE unit.hitpoints $unit.max_hitpoints|}
								[unstore_unit]
									variable=unit
									find_vacant=no
								[/unstore_unit]
								[message]
									speaker=narrator
									message=_ "You are fully healed from the recharge machine."
								[/message]
							[/then]
						)}
					[/then]
				)}
				
				# end of falling while loop...
				
			[/do]
		[/while]
		
		# restore the location again to prevent problems...
		
		[store_locations]
			x=$unit.x|
			y=$unit.y|
			variable=ter
		[/store_locations]
		
		# walk to recharge machine...
		
		{IF_VAR ter.terrain equals Cud (
			[then]
				{IF_VAR unit.hitpoints not_equals $unit.max_hitpoints| (
					[then]
						[sound]
							name=lightning-miss.ogg
						[/sound]
						[kill]
							x,y=$unit.x,$unit.y
						[/kill]
						{VARIABLE unit.hitpoints $unit.max_hitpoints|}
						[unstore_unit]
							variable=unit
							find_vacant=no
						[/unstore_unit]
						[message]
							speaker=narrator
							message=_ "You are fully healed from the recharge machine."
						[/message]
					[/then]
				)}
			[/then]
		)}
		
		# land on the ground...
		# note: changed sound because it annoys you after awhile...
		# this sound should be less annoying compared to the club hit sound...
		
		{IF_VAR ter.terrain not_equals Ce (
			[then]
				[sound]
					name=petrified.ogg
				[/sound]
			[/then]
			[else]
				{IF_VAR hook equals yes (
					[then]
						[sound]
							name=dart.wav
						[/sound]
					[/then]
				)}
			[/else]
		)}
	[/event]
	
	# gravity for enemy creatures...
	# note: i am temporarely commenting this out for now... i am unsure if this is safe for memory or not with the errors that generate...
	# i will add this back in if it is safe...
	# edit: I was told by crab that the game tries to prevent ai errors and whatnot so this may not be an issue. he also suggests that a bugfix was introduced as well... it should improve catching this...
	# https://gna.org/bugs/?16102
	# so I will uncomment this for now. It can still cause error messages. (which I hate but, I want the game to function this way...) although, they shouldn't be too much of a problem...
	
	[event]
		name=moveto,attack end
		first_time_only=no
		[filter]
			side=2
			type="Smlug", "Peko", "Versant", "Rephel"
		[/filter]
		[while]
			
			# while there is no Xu/Xos terrains below you, and no enemies/allies below you, you can fall...
			
			[have_location]
				x,y=$unit.x,$unit.y
				[filter_adjacent_location]
					adjacent=s
					[not]
						terrain=Xu,Xos
					[/not]
					[not]
						[filter]
							side=1,2
						[/filter]
					[/not]
				[/filter_adjacent_location]
			[/have_location]
			[do]
				
				# falling code...
				
				# scroll 1 hex down, kill/create new leader with +1 to y, and play a sound as if he is falling...
				
				[scroll_to]
					x,y=$unit.x,$unit.y
				[/scroll_to]
				[kill]
					x,y=$unit.x,$unit.y
				[/kill]
				{VARIABLE_OP unit.y add 1}
				[unstore_unit]
					variable=unit
					find_vacant=no
				[/unstore_unit]
				[sound]
					name=dagger-swish.wav
				[/sound]
				
				# we must know where we fell to...
				
				[store_locations]
					x=$unit.x|
					y=$unit.y|
					variable=ter
				[/store_locations]
				
				# landing in water sound/death...
				
				{IF_VAR ter.terrain equals Ww (
					[then]
						[sound]
							name=water-blast.wav
						[/sound]
					[/then]
				)}
				
				# landing in swamp sound/death...
				
				{IF_VAR ter.terrain equals Ss (
					[then]
						[sound]
							name=water-blast.wav
						[/sound]
					[/then]
				)}
				
				# end of falling while loop...
				
			[/do]
		[/while]
	[/event]
	
[/scenario]